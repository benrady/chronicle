#!/bin/bash

pdf=$1
name=`basename $pdf .pdf`

if [[ ! -e $pdf ]]; then
  echo "Usage: $0 scenario_pdf"
  exit 1
fi

if [[ ! -e chronicle_sheet.png ]]; then
  echo "Extracting chronicle sheet..."
  page_count=`docsplit length $pdf`
  docsplit images -d 300 -p $page_count $pdf
  mv $name*.png chronicle_sheet.png
fi

echo "Downloading latest bestiary..."
wget https://spreadsheets.google.com/feeds/list/0AhwDI9kFz9SddGFBN1RBc25yU2syZU5DRktXUkpPanc/default/public/basic -o bestiary.xml

echo "Generating encounters app..."
pdftotext $pdf
#FIXME

# http://stackoverflow.com/questions/2897619/using-html5-javascript-to-generate-and-save-a-file


